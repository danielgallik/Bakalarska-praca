@model Alarmee.Web.Models.PlanDetailModel

<div class="hospitalPlan">
    <div class="infoPlan">
        <canvas id="planCanvas" width="780" height="700"></canvas>
    </div>

    @foreach (var bed in Model.Beds)
    {
        <script>
            var canvas = document.getElementById('planCanvas');
            var context = canvas.getContext('2d');

            context.beginPath();
            context.rect(@bed.Vertices[0].X, @bed.Vertices[0].Y, @bed.Vertices[1].X, @bed.Vertices[1].Y);
            context.fillStyle = @Html.Raw(Json.Encode(bed.Color));
            context.fill();
            context.stroke();

            context.font = '20pt Calibri';
            context.fillStyle = 'white';
            context.fillText(@Html.Raw(Json.Encode(bed.Name)), @bed.NamePosition.X, @bed.NamePosition.Y);
        </script>
    }

    @foreach (var room in Model.Rooms)
    {
        <script>
            var canvas = document.getElementById('planCanvas');
            var context = canvas.getContext('2d');

            context.beginPath();
            context.moveTo(@room.Vertices[0].X, @room.Vertices[0].Y);
            context.lineTo(@room.Vertices[1].X, @room.Vertices[1].Y);
            context.lineTo(@room.Vertices[2].X, @room.Vertices[2].Y);
            context.lineTo(@room.Vertices[3].X, @room.Vertices[3].Y);
            context.lineTo(@room.Vertices[0].X, @room.Vertices[0].Y);
            context.stroke();

            context.font = 'bold 20pt Calibri';
            context.fillStyle = @Html.Raw(Json.Encode(room.Color));
            context.fillText(@Html.Raw(Json.Encode(room.Name)), @room.NamePosition.X, @room.NamePosition.Y);
        </script>
    }
    <div class="infoBoxes">
        <div id="pumpBox" class="infoBox">
            <h2>Remaining Times</h2>
            <hr />
            <div id="pumpList">
                <div class="pumpListHead">
                    <div class="pump">
                        <span class="pumpBed">Bed</span>
                        <span class="pumpRemTime">Rem.Time</span>
                        <span class="pumpInfo">Medication</span>
                        <span class="pumpType">Type</span>
                    </div>
                </div>
                <div class="pumpListBody">
                    @foreach (var pump in @Model.Pumps)
                    {
                        <div class="pump">
                            <span class="pumpBed">@pump.Bed</span>
                            <span class="pumpRemTime">@pump.RemainingTime</span>
                            <span class="pumpInfo">@pump.Medicament</span>
                            <span class="pumpType">@pump.Type</span>
                            <div class="pumpProgress"><span style="display:block;color:white;background-color:@pump.ProgressColor;width:@pump.Progress%;">.</span></div>
                        </div>
                    }
                </div>
            </div>
        </div>
        <div id="alertBox" class="infoBox">
            <h2>Alerts</h2>
            <hr />
            <table id="alertList">
                <tbody>
                    @foreach (var alert in @Model.Alerts)
                    {
                        <tr class="alert" style="background-color:@alert.Color;">
                            <td class="alertBed"><b>@alert.Bed</b></td>
                            <td class="alertMessage">
                                <b>@alert.Message</b><br />
                                <i>@alert.Medicament</i>
                            </td>
                            <td class="alertType">@alert.Type</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
